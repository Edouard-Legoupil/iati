% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/show_donor_funding_volatility.R
\name{show_donor_funding_volatility}
\alias{show_donor_funding_volatility}
\title{Plot donor funding volatility}
\usage{
show_donor_funding_volatility(
  donor_name,
  year = NULL,
  programme_lab = NULL,
  iati_identifier_ops = NULL,
  ctr_name = NULL,
  top_n_donors = NULL,
  time_unit = c("month", "quarter"),
  smooth_method = c("loess", "gam"),
  forecast_horizon = 6,
  show_forecast_ci = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{donor_name}{Character. The donor to plot.}

\item{year}{Optional integer/numeric vector. Filter years (e.g., 2023 or c(2022,2023)).}

\item{programme_lab}{Optional character vector. Filter on programme label.}

\item{iati_identifier_ops}{Optional character vector. Filter on operation identifier.}

\item{ctr_name}{Optional character vector. Filter on recipient country name (ctr_name).}

\item{top_n_donors}{Optional integer. If provided, restricts comparator to
the top N donors by total funding amount (USD) across the filtered period.
NULL (default) includes all other donors in the comparator.}

\item{time_unit}{Aggregation unit for trend line: "month" (default) or "quarter".}

\item{smooth_method}{Smoother for trend line: "loess" (default) or "gam".}

\item{forecast_horizon}{Integer. Number of periods (months/quarters) to forecast.}

\item{show_forecast_ci}{Logical. If TRUE, show a confidence ribbon for the forecast.}

\item{verbose}{Logical. Print small diagnostics.}
}
\value{
A ggplot object.
}
\description{
Creates a volatility view of a donor's incoming commitments:
- Points: transaction-level USD amounts for the selected donor
- Smoothed line: monthly/quarterly mean transaction value (donor)
- Comparator: weighted mean transaction value for other donors,
  weighted by each donor's total received amount (under the same filters)
- Forecast: simple trend model (lm on log1p period mean) extended forward

Title/subtitle highlight average amount per transaction and average number of 
transactions per year for the donor vs weighted averages for other donors combined.
}
\examples{
# Donor Funding Volatility

show_donor_funding_volatility(
  donor_name = "Private donors",
  time_unit = "quarter",
  forecast_horizon = 8
)

show_donor_funding_volatility(
  donor_name = "Private donors",
  year = 2022:2026,
  top_n_donors = 10,,
  forecast_horizon = 8,
  time_unit = "month"
)

show_donor_funding_volatility(donor_name = "Private donors", 
                              ctr_name = "Brazil")
}
